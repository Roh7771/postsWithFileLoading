!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);n(1),n(2)},function(t,e,n){},function(t,e){function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="https://posts-on-express.herokuapp.com",c=0,i=0,s=document.getElementById("root"),d=document.createElement("form");d.enctype="multipart/form-data",d.innerHTML='\n    <div class="form-group mt-2">\n        <input required placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç" class="form-control" data-type="text">\n    </div>\n    <div class="form-group output d-flex justify-content-center">\n    </div>\n    <div class="form-group d-flex justify-content-center" data-type="btnsCntr">\n        <button class="btn btn-primary mr-2" data-type="audio">–î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏–æ–∑–∞–ø–∏—Å—å</button>\n        <button class="btn btn-primary mr-2" data-type="video">–î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å—å</button>\n        <label class="mb-0" for="image">\n            <div class="btn btn-primary cursor-pointer" data-type="image">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</div>\n        </label>\n        <input type="file" id=\'image\' name="image">\n    </div>\n    <button type="submit" class="btn btn-primary mx-auto d-block" data-type="button">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>\n';var l={type:"–û–±—ã—á–Ω—ã–π"},u=document.createElement("span");u.classList.add("close"),u.addEventListener("click",S);var p=d.querySelector(".output"),f=d.querySelector("[data-type=audio]"),b=d.querySelector("[data-type=video]"),m=d.querySelector("[data-type=image]"),v=d.querySelector("input[name=image]"),y=d.querySelector("[data-type=button]"),h=[y,m,b,f];d.querySelector("[data-type=btnsCntr]").addEventListener("click",(function(t){var e=t.target.dataset.type;"audio"!==e&&"video"!==e||(t.preventDefault(),function(t,e){if(!navigator.mediaDevices){var n=document.createElement("div");return n.textContent="Your browser not support media!",void document.body.appendChild(n)}if(!window.MediaRecorder){var r=document.createElement("div");return r.textContent="Your browser not media recordering! Use Yande Browser.",void document.body.appendChild(r)}var o=document.createElement(t);o.controls=!0,p.appendChild(o),j();var c={audio:!0,video:"video"===t};navigator.mediaDevices.getUserMedia(c).then((function(n){var r=new MediaRecorder(n,{mediaType:"".concat(t,"/webm")}),c=[];r.addEventListener("dataavailable",(function(t){c.push(t.data)})),r.addEventListener("stop",(function(r){n.getTracks().forEach((function(t){return t.stop()}));var i=new Blob(c);o.srcObject=null;var s=new FormData;s.append("media",i),p.innerHTML="",e.innerHTML="–ò–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞...",fetch("".concat(a,"/upload"),{method:"POST",body:s}).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json()})).then((function(n){var r="".concat(a,"/static/").concat(n.name),o=document.createElement(t);o.src=r,o.controls=!0,p.appendChild(o),e.innerHTML="–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞",l.url=r,p.appendChild(u)})).catch((function(t){console.log(t)})).finally((function(){y.disabled=!1}))})),r.start(),e.innerHTML="–ò–¥–µ—Ç –∑–∞–ø–∏—Å—å...",o.srcObject=n,o.muted=!0,o.play(),setTimeout((function(){r.stop()}),5e3)})).catch((function(t){console.log(t.message)}))}(e,t.target),l.type="audio"===e?"–ê—É–¥–∏–æ":"–í–∏–¥–µ–æ")})),v.addEventListener("change",(function(t){t.preventDefault(),j(),l.type="–ö–∞—Ä—Ç–∏–Ω–∫–∞",m.innerHTML="–ò–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞...";var e=o(Array.from(t.currentTarget.files),1)[0],n=new FormData;n.append("media",e),fetch("".concat(a,"/upload"),{method:"POST",body:n}).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json()})).then((function(t){var e="".concat(a,"/static/").concat(t.name);l.url=e;var n=document.createElement("img");n.src=e,p.appendChild(n),m.innerHTML="–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞",p.appendChild(u)})).catch((function(t){console.log(t)})).finally((function(){y.disabled=!1})),t.currentTarget.value=""})),d.addEventListener("submit",(function(t){t.preventDefault();var e=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},l,{text:g.value});fetch("".concat(a,"/posts"),{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},method:"POST"}).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json()})).then((function(t){g.value="",localStorage.clear(),S(),x(t)})).catch((function(t){console.log(t)}))}));var g=d.querySelector("[data-type=text]");g.value=localStorage.getItem("text"),g.addEventListener("input",(function(t){localStorage.setItem("text",t.currentTarget.value)})),s.appendChild(d);var k=document.createElement("button");k.className="btn btn-primary mx-auto mt-2 mb-2 d-none",k.innerHTML="–°–≤–µ–∂–∏–µ –ø–æ—Å—Ç—ã!",k.addEventListener("click",(function(){k.classList.remove("d-block"),k.classList.add("d-none"),fetch("".concat(a,"/posts/get-fresh-posts/").concat(c)).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json()})).then((function(t){x(t)})).catch((function(t){console.log(t)}))})),s.appendChild(k);var L=document.createElement("div");s.appendChild(L);var T=document.createElement("button");function w(){fetch("".concat(a,"/posts/get-old-posts/").concat(i)).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json()})).then((function(t){!function(t){if(t.sort((function(t,e){return e.id-t.id})),t.length<5){if(T.classList.add("d-none"),T.classList.remove("d-block"),0===t.length)return}else fetch("".concat(a,"/posts/old-posts-check/").concat(t[t.length-1].id)).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.text()})).then((function(t){"true"===t&&(T.classList.add("d-none"),T.classList.remove("d-block"))})).catch((function(t){console.log(t)}));0===c&&(c=t[0].id);i=t[t.length-1].id;var e=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var d=o.value;L.appendChild(E(d))}}catch(t){n=!0,r=t}finally{try{e||null==s.return||s.return()}finally{if(n)throw r}}}(t)})).catch((function(t){console.log(t)}))}function x(t){if(Array.isArray(t)){if(0===t.length)return;t.sort((function(t,e){return e.id-t.id})),c=t[0].id;var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;L.insertBefore(E(i),L.children[0])}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}else c=t.id,L.insertBefore(E(t),L.children[0])}function E(t){var e=document.createElement("div");e.className="card mt-3","–û–±—ã—á–Ω—ã–π"===t.type?e.innerHTML='\n            <div class="card">\n                <div class="card-body">\n                    <p class="card-text">'.concat(t.text,'</p>\n                    <button data-action="like" class="btn btn-primary mr-2">‚ù§ ').concat(t.likes,'</button>\n                    <button data-action="dislike" class="btn btn-primary mr-2">üëé</button>\n                    <button data-action="delete" class="btn btn-primary">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            </div>\n       '):"–ö–∞—Ä—Ç–∏–Ω–∫–∞"===t.type?e.innerHTML='\n            <div class="card">\n                <img src="'.concat(t.url,'" class="card-img-top">\n                <div class="card-body">\n                    <p class="card-text">').concat(t.text,'</p>\n                    <button data-action="like" class="btn btn-primary mr-2">‚ù§ ').concat(t.likes,'</button>\n                    <button data-action="dislike" class="btn btn-primary mr-2">üëé</button>\n                    <button data-action="delete" class="btn btn-primary">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            </div>\n       '):"–í–∏–¥–µ–æ"===t.type?e.innerHTML='\n            <div class="card">\n                <div class="card-img-top embed-responsive embed-responsive-16by9">\n                    <video src="'.concat(t.url,'" controls=""></video>\n                </div>\n                <div class="card-body">\n                    <p class="card-text">').concat(t.text,'</p>\n                    <button data-action="like" class="btn btn-primary mr-2">‚ù§ ').concat(t.likes,'</button>\n                    <button data-action="dislike" class="btn btn-primary mr-2">üëé</button>\n                    <button data-action="delete" class="btn btn-primary">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            </div>\n       '):"–ê—É–¥–∏–æ"===t.type&&(e.innerHTML='\n            <div class="card">\n                <audio controls="" class="card-img-top" src="'.concat(t.url,'"></audio>\n                <div class="card-body">\n                <p class="card-text">').concat(t.text,'</p>\n                    <button data-action="like" class="btn btn-primary mr-2">‚ù§ ').concat(t.likes,'</button>\n                    <button data-action="dislike" class="btn btn-primary mr-2">üëé</button>\n                    <button data-action="delete" class="btn btn-primary">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            </div>\n       '));var n=e.querySelector("[data-action=like]");return e.addEventListener("click",(function(r){"like"===r.target.dataset.action?O("like",t.id,n):"dislike"===r.target.dataset.action?O("dislike",t.id,n):"delete"===r.target.dataset.action&&(fetch("".concat(a,"/posts/").concat(t.id),{method:"DELETE"}).then((function(t){if(!t.ok)throw new Error(t.statusText)})).catch((function(t){console.log(t)})),L.removeChild(e))})),e}function O(t,e,n){fetch("".concat(a,"/posts/").concat(t,"/").concat(e),{method:"POST"}).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.text()})).then((function(t){n.innerHTML="‚ù§ ".concat(t)})).catch((function(t){console.log(t)}))}function j(){h.forEach((function(t){"image"===t.dataset.type?(t.classList.add("disabled"),t.classList.remove("cursor-pointer"),t.closest("label").setAttribute("for","")):t.disabled="true"}))}function S(){p.innerHTML="",h.forEach((function(t){"image"===t.dataset.type?(t.classList.remove("disabled"),t.classList.add("cursor-pointer"),t.closest("label").setAttribute("for","image")):t.disabled=!1})),"–ê—É–¥–∏–æ"===l.type?f.innerHTML="–î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏–æ–∑–∞–ø–∏—Å—å":"–í–∏–¥–µ–æ"===l.type?b.innerHTML="–î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å—å":m.innerHTML="–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É",l={type:"–û–±—ã—á–Ω—ã–π"}}T.className="btn btn-primary d-block mx-auto mt-2",T.innerHTML="–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ –ø–æ—Å—Ç—ã",T.addEventListener("click",w),s.appendChild(T),w(),setInterval((function(){fetch("".concat(a,"/posts/fresh-posts-check/").concat(c)).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.text()})).then((function(t){"false"!==t&&(k.classList.remove("d-none"),k.classList.add("d-block"))})).catch((function(t){console.log(t)}))}),5e3)}]);